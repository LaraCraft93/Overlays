box: gentoo/stage3-amd64

build:
    steps:

        - script:
            name: Checking ebuilds
            code: |
                wget http://distfiles.gentoo.org/snapshots/portage-latest.tar.bz2
                mkdir -p /usr
                bzcat portage-latest.tar.bz2 | tar -xf - -C /usr
                mkdir -p /usr/portage/distfiles /usr/portage/metadata /usr/portage/packages
                emerge --sync
                emerge dev-vcs/git repoman
                git clone https://github.com/ShyPixie/Overlays
                cd Overlays
                repoman -Sd --without-mask full

        - script:
            name: Testing ebuild
            code: |
                cd Overlays
                for file in $(find . -iname '*.ebuild'); do
                    ebuild $file clean compile install qmerge || break;
                done
