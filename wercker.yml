box: gentoo/stage3-amd64

build:
    steps:

        - script:
            name: Checking ebuilds
            code: |
                curl -o portage-latest.tar.bz2 http://distfiles.gentoo.org/snapshots/portage-latest.tar.bz2
                mkdir -p /usr
                bzcat /portage-latest.tar.bz2 | tar -xf - -C /usr
                mkdir -p /usr/portage/distfiles /usr/portage/metadata /usr/portage/packages
                echo "gentoo" > /usr/portage/profiles/repo_name
                emerge sync
                emerge repoman
                repoman -Sd --without-mask full

        - script:
            name: Testing ebuild
            code: find -iname '*.ebuild' -exec ebuild {} clean compile install \;
